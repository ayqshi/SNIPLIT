<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="SNIPLIT">
    <meta name="application-name" content="SNIPLIT">
    <meta name="theme-color" content="#000000">
    <meta name="description" content="Pro Audio Discovery Engine & Music Analytics">
    <meta name="format-detection" content="telephone=no">
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="icon" href="src/SNIPLIT.png" type="image/x-icon">
    <link rel="icon" href="src/SNIPLIT.png" type="image/png" sizes="32x32">
    <link rel="icon" href="src/SNIPLIT.png" type="image/png" sizes="16x16">
    <link rel="icon" href="src/SNIPLIT.png" type="image/svg+xml">
    <link rel="apple-touch-icon" sizes="180x180" href="src/SNIPLIT.png">

    <!-- PWA Manifest with custom Base64 Icon -->
    <link rel="manifest" href="index.json">

    <title>SNIPLIT</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;700&display=swap"
        rel="stylesheet">
    <link href="src/app.css" rel="stylesheet">

</head>

<body>

    <!-- === SPLASH SCREEN === -->
    <div id="splash-screen">
        <h1 class="text-6xl font-black tracking-tighter mb-2" style="color: var(--text-primary);">SNIPLIT</h1>
        <p class="text-xs font-mono uppercase tracking-[0.3em] mb-8" style="color: var(--text-tertiary);">Audio
            Intelligence</p>
        <div
            class="w-10 h-10 border-2 border-[var(--bg-elevated)] border-t-[var(--text-primary)] rounded-full animate-spin">
        </div>
    </div>

    <!-- === ONBOARDING === -->
    <div id="onboarding-layer"
        class="hidden fixed inset-0 bg-[var(--bg-app)] z-[5000] flex flex-col p-8 overflow-y-auto">
        <div id="ob-terms" class="max-w-md mx-auto w-full flex flex-col h-full justify-center space-y-6">
            <h2 class="text-3xl font-black tracking-tight">Welcome</h2>
            <p class="text-sm leading-relaxed" style="color: var(--text-secondary);">
                SNIPLIT uses advanced algorithms and usage patterns to curate your audio experience. We store your preferences locally (secure profiling).
                SNIPLIT does not host any copyrighted material, file hosts are provided via API and other 3rd party sources.
                You must be of 13 years of age to use SNIPLIT.
                By continuing, you agree to our simulated Terms of Service.
            </p>
            <div class="bg-[var(--bg-surface)] p-4 rounded-xl border border-[var(--border-subtle)]">
                <label class="text-xs font-bold uppercase mb-2 block"
                    style="color: var(--text-tertiary);">Username</label>
                <input type="text" id="survey-name"
                    class="w-full bg-[var(--bg-app)] border border-[var(--border-default)] rounded-xl p-4 text-white font-bold outline-none focus:border-[var(--accent-secondary)] transition"
                    placeholder="Enter your alias">
                <div>
                    <div class="mt-4">
                        <label class="block text-xs font-bold text-zinc-500 uppercase mb-2">Select Favorite
                            Genre</label>
                        <select id="ob-genre-select"
                            class="w-full bg-zinc-800 text-white p-3 rounded-xl border border-zinc-700 outline-none appearance-none">
                            <option value="Pop">Pop</option>
                            <option value="Rock">Rock</option>
                            <option value="Hip-Hop">Hip-Hop</option>
                            <option value="Electronic">Electronic</option>
                            <option value="Alternative">Alternative</option>
                            <option value="R&B">R&B</option>
                            <option value="Indie">Indie</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
        <button onclick="Onboarding.finish()"
            class="w-full py-4 bg-[var(--text-primary)] text-[var(--text-inverse)] font-bold uppercase tracking-widest rounded-full shadow-lg active:scale-95 transition">Initialize</button>
    </div>
    </div>

    <!-- === MAIN APP CONTAINER === -->
    <div id="app-container"
        class="relative w-full h-full max-w-[480px] max-h-[950px] bg-[var(--bg-app)] md:border-[8px] md:border-[#1a1a1a] md:rounded-[3rem] overflow-hidden flex flex-col shadow-[0_0_60px_rgba(0,0,0,1)]">

        <!-- Status Bar Spacer -->
        <div
            class="h-12 w-full flex items-center justify-between px-8 text-[11px] font-semibold opacity-0 z-50 absolute top-0 bg-gradient-to-b from-[var(--bg-app)] to-transparent pointer-events-none">
            <span id="system-time" class="font-mono">--:--</span>
            <div class="flex gap-2">
                <i data-lucide="wifi" class="w-3 h-3"></i>
                <i data-lucide="battery" class="w-3 h-3"></i>
            </div>
        </div>

        <!-- Header -->
        <header class="pt-14 px-6 pb-4 flex justify-between items-center z-40 relative">
            <div>
                <h1 class="text-2xl font-black tracking-tight" style="color: var(--text-primary);">SNIPLIT</h1>
                <p id="greeting" class="text-[10px] font-bold uppercase tracking-widest"
                    style="color: var(--text-tertiary);">System Ready</p>
            </div>
            <div class="flex gap-3">
                <button onclick="UI.showWrapped()"
                    class="p-2.5 surface rounded-full hover:bg-[var(--bg-surface-hover)] transition active:scale-95">
                    <i data-lucide="bar-chart-2" class="w-5 h-5" style="color: var(--text-secondary);"></i>
                </button>
                <button onclick="UI.openSettings()"
                    class="p-2.5 surface rounded-full hover:bg-[var(--bg-surface-hover)] transition active:scale-95">
                    <i data-lucide="settings-2" class="w-5 h-5" style="color: var(--text-secondary);"></i>
                </button>
            </div>
        </header>

        <!-- Notification Banner (Config Import) -->
        <div id="notification-bar"
            class="hidden mx-6 mb-4 p-3 rounded-xl border border-[var(--border-subtle)] bg-8f25eb-600/10 border-8f25eb-600/20 flex items-center gap-3 animate-slide-up">
            <i data-lucide="database" class="w-5 h-5 text-8f25eb-500"></i>
            <div class="flex-1 text-xs">
                <p class="font-bold text-purple-400">Application Available</p>
                <p class="opacity-80">Add to your Home Screen for the best app-like experience. </p>
            </div>
            <button onclick="document.getElementById('notification-bar').remove()"
                class="text-8f25eb-500 hover:text-white"><i data-lucide="x" class="w-4 h-4"></i></button>
        </div>

        <!-- Main Viewport -->
        <main id="view-port" class="flex-1 overflow-y-auto no-scrollbar px-6 pb-32 relative z-10 scroll-smooth">

            <!-- === HOME VIEW === -->
            <section id="view-home" class="view-section space-y-8 pt-2 pb-10">

                <!-- Jump Back In (With Fallback) -->
                <div>
                    <div class="flex justify-between items-end mb-4">
                        <h2 class="text-xs font-bold uppercase tracking-widest flex items-center gap-2"
                            style="color: var(--text-tertiary);">
                            <i data-lucide="history" class="w-3 h-3"></i> Jump Back In
                        </h2>
                    </div>
                    <div id="recents-grid" class="grid grid-cols-2 gap-3">
                        <!-- Injected JS -->
                    </div>
                </div>

                <!-- For You / Discovery Engine -->
                <div>
                    <h2 class="text-xs font-bold uppercase tracking-widest mb-4 flex items-center gap-2"
                        style="color: var(--text-tertiary);">
                        <i data-lucide="sparkles" class="w-3 h-3"></i> Made For You
                    </h2>
                    <!-- Discovery Tabs -->
                    <div class="flex gap-3 overflow-x-auto no-scrollbar mb-4">
                        <button onclick="UI.setDiscoveryMode('daily')"
                            class="px-4 py-1.5 bg-[var(--text-primary)] text-[var(--text-inverse)] text-[10px] font-bold uppercase rounded-full whitespace-nowrap transition shadow-lg"
                            id="tab-daily">Daily Mix</button>
                        <button onclick="UI.setDiscoveryMode('radio')"
                            class="px-4 py-1.5 surface text-[var(--text-secondary)] text-[10px] font-bold uppercase rounded-full whitespace-nowrap transition hover:bg-[var(--bg-surface-hover)]"
                            id="tab-radio">Radio</button>
                        <button onclick="UI.setDiscoveryMode('discover')"
                            class="px-4 py-1.5 surface text-[var(--text-secondary)] text-[10px] font-bold uppercase rounded-full whitespace-nowrap transition hover:bg-[var(--bg-surface-hover)]"
                            id="tab-discover">Discover</button>
                    </div>
                    <div id="for-you-grid" class="grid grid-cols-2 sm:grid-cols-3 gap-4">
                        <!-- Injected JS -->
                    </div>
                </div>

                <!-- Progressive Sections Container (Intersection Observer Target) -->
                <div id="home-genres-container" class="space-y-10 pb-24">
                    <!-- Dynamic Sections: Pop, Rock, Hip-Hop, etc. -->
                </div>

                <!-- Loading Sentinel -->
                <div id="scroll-sentinel" class="h-20 flex items-center justify-center opacity-0">
                    <div
                        class="w-6 h-6 border-2 border-[var(--bg-elevated)] border-t-[var(--text-primary)] rounded-full animate-spin">
                    </div>
                </div>
            </section>

            <!-- === SEARCH VIEW === -->
            <section id="view-search" class="view-section hidden space-y-6 pt-4 pb-20">
                <div class="sticky top-0 bg-[var(--bg-app)]/95 backdrop-blur z-20 pb-2 pt-2">
                    <div class="relative group">
                        <i data-lucide="search"
                            class="absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 transition-colors duration-300"
                            style="color: var(--text-tertiary);"></i>
                        <input type="text" id="main-search" placeholder="Search artists, songs..."
                            class="w-full bg-[var(--bg-surface)] border border-[var(--border-subtle)] rounded-2xl py-4 pl-12 pr-4 text-sm focus:outline-none focus:border-[var(--accent-secondary)] transition-all font-medium shadow-lg placeholder-zinc-600"
                            style="color: var(--text-primary);">
                    </div>
                </div>

                <!-- Animated Loading -->
                <div id="search-loading" class="hidden flex justify-center py-10 animate-fade-in">
                    <div
                        class="w-8 h-8 border-2 border-[var(--bg-elevated)] border-t-[var(--text-primary)] rounded-full animate-spin">
                    </div>
                </div>

                <!-- Search History -->
                <div id="search-history-panel" class="hidden">
                    <div class="flex justify-between items-center mb-2">
                        <h3 class="text-[10px] font-bold uppercase tracking-widest"
                            style="color: var(--text-tertiary);">Recent</h3>
                        <button onclick="Database.clearSearchHistory()"
                            class="text-[10px] text-red-500 font-bold uppercase hover:underline">Clear</button>
                    </div>
                    <div id="search-history-chips" class="flex flex-wrap gap-2"></div>
                </div>

                <div id="search-results" class="space-y-2 min-h-[200px]"></div>
            </section>

            <!-- === LIBRARY VIEW === -->
            <section id="view-library" class="view-section hidden pt-4 space-y-6 pb-20">
                <div class="flex gap-2 overflow-x-auto no-scrollbar pb-2">
                    <button
                        class="bg-[var(--text-primary)] text-[var(--text-inverse)] px-5 py-2.5 rounded-full text-xs font-black uppercase tracking-wider shadow-lg flex-shrink-0">Library</button>
                    <button onclick="UI.showCreatePlaylist()"
                        class="surface px-5 py-2.5 rounded-full text-xs font-bold uppercase tracking-wider border border-[var(--border-subtle)] hover:bg-[var(--bg-surface-hover)] transition flex-shrink-0 flex items-center gap-2"
                        style="color: var(--text-secondary);"><i data-lucide="plus" class="w-3 h-3"></i> New</button>
                    <button onclick="LocalFiles.triggerFile()"
                        class="surface px-5 py-2.5 rounded-full text-xs font-bold uppercase tracking-wider border border-[var(--border-subtle)] hover:bg-[var(--bg-surface-hover)] transition flex-shrink-0 flex items-center gap-2"
                        style="color: var(--text-secondary);"><i data-lucide="file-audio" class="w-3 h-3"></i>
                        File</button>
                </div>
                <div id="library-list" class="space-y-1 pb-24"></div>
            </section>

            <!-- === GENERIC LIST VIEW (Artist, Playlist, Liked, Local) === -->
            <section id="view-list" class="view-section hidden pt-4 space-y-6 pb-20">
                <button onclick="Router.back()"
                    class="flex items-center gap-2 text-[10px] font-bold uppercase tracking-widest w-fit mb-4"
                    style="color: var(--text-tertiary);"><i data-lucide="arrow-left" class="w-3 h-3"></i> Back</button>
                <div id="list-hero" class="space-y-4 animate-slide-up"></div>
                <div id="list-tracks" class="space-y-1"></div>
            </section>

        </main>

        <!-- === MINI PLAYER === -->
        <div id="mini-player"
            class="hidden absolute bottom-24 left-4 right-4 glass rounded-2xl p-2.5 flex items-center gap-3 z-50 border border-[var(--border-subtle)] cursor-pointer shadow-2xl transition-all duration-300 hover:scale-[1.01]"
            onclick="UI.togglePlayer(true)">
            <img id="mini-art" src="" class="w-10 h-10 rounded-lg object-cover bg-[var(--bg-surface)] shadow-lg">
            <div class="flex-1 min-w-0 flex flex-col justify-center">
                <h4 id="mini-title" class="text-xs font-bold truncate" style="color: var(--text-primary);">Not Playing
                </h4>
                <p id="mini-artist" class="text-[10px] font-medium truncate uppercase tracking-wider"
                    style="color: var(--text-tertiary);">Select a track</p>
            </div>
            <div class="flex items-center gap-2 pr-2">
                <button onclick="event.stopPropagation(); AudioEngine.toggle()"
                    class="p-2 bg-[var(--bg-elevated)] rounded-full active:scale-90 transition"><i data-lucide="play"
                        id="mini-play-icon" class="w-4 h-4 fill-[var(--text-primary)]"></i></button>
            </div>
            <div class="absolute bottom-0 left-2 right-2 h-[2px] bg-[var(--bg-elevated)] rounded-full overflow-hidden">
                <div id="mini-progress"
                    class="h-full bg-[var(--accent-secondary)] w-0 transition-all duration-300 ease-linear rounded-full">
                </div>
            </div>
        </div>

        <!-- === NAV BAR === -->
        <nav
            class="h-24 glass flex items-center justify-around px-2 pb-2 z-40 relative border-t border-[var(--border-subtle)]">
            <button onclick="Router.go('home')"
                class="nav-btn active flex flex-col items-center gap-1.5 w-16 transition-colors" data-view="home">
                <i data-lucide="home" class="w-5 h-5 group-[.active]:text-white transition-colors"
                    style="color: var(--text-tertiary);"></i>
                <span
                    class="text-[9px] font-bold uppercase tracking-widest group-[.active]:text-white transition-colors"
                    style="color: var(--text-tertiary);">Home</span>
            </button>
            <button onclick="Router.go('search')"
                class="nav-btn flex flex-col items-center gap-1.5 w-16 transition-colors" data-view="search">
                <i data-lucide="search" class="w-5 h-5 group-[.active]:text-white transition-colors"
                    style="color: var(--text-tertiary);"></i>
                <span
                    class="text-[9px] font-bold uppercase tracking-widest group-[.active]:text-white transition-colors"
                    style="color: var(--text-tertiary);">Find</span>
            </button>
            <button onclick="Router.go('library');UI.renderLibrary();"
                class="nav-btn flex flex-col items-center gap-1.5 w-16 transition-colors" data-view="library">
                <i data-lucide="library" class="w-5 h-5 group-[.active]:text-white transition-colors"
                    style="color: var(--text-tertiary);"></i>
                <span
                    class="text-[9px] font-bold uppercase tracking-widest group-[.active]:text-white transition-colors"
                    style="color: var(--text-tertiary);">Data</span>
            </button>
        </nav>

        <!-- === FULL PLAYER OVERLAY === -->
        <div id="full-player"
            class="hidden fixed inset-0 z-[100] bg-[var(--bg-app)] translate-y-full transition-transform duration-500 cubic-bezier(0.32, 0.72, 0, 1) flex flex-col">
            <!-- Top Controls -->
            <div class="px-8 pt-12 flex justify-between items-center z-30 relative">
                <button onclick="UI.togglePlayer(false)" class="p-2 opacity-50 hover:opacity-100 transition"><i
                        data-lucide="chevron-down" class="w-6 h-6"></i></button>
                <div class="text-center">
                    <p class="text-[10px] font-bold uppercase tracking-[0.3em] opacity-50">Now Streaming</p>
                    <p id="player-quality" class="text-[9px] font-mono mt-1 opacity-0 transition">HQ • LOSSLESS</p>
                </div>
                <button onclick="UI.toggleLyrics()" class="p-2 opacity-50 hover:opacity-100 transition"><i
                        data-lucide="mic-2" class="w-5 h-5"></i></button>
            </div>

            <!-- Visual Area -->
            <div class="flex-1 flex flex-col items-center justify-center p-6 relative overflow-hidden">
                <canvas id="viz-canvas"></canvas>
                <div
                    class="relative z-10 w-full max-w-[320px] aspect-square rounded-[2rem] overflow-hidden shadow-[0_40px_100px_rgba(0,0,0,0.3)] border border-white/5 ring-1 ring-white/10 bg-zinc-900">
                    <img id="player-art" src="" class="w-full h-full object-cover">
                </div>
                <!-- Lyrics Panel (Hidden by default) -->
                <div id="lyrics-panel"
                    class="absolute inset-0 z-20 flex flex-col pt-24 px-4 pb-32 overflow-y-auto no-scrollbar hidden">
                    <div id="lyrics-container" class="flex flex-col items-center space-y-6 w-full"></div>
                </div>
            </div>

            <!-- Controls -->
            <div class="px-8 pb-12 space-y-8 relative z-30">
                <div class="flex justify-between items-end">
                    <div class="flex-1 min-w-0 pr-4 space-y-1">
                        <div class="flex items-center gap-2 mb-1">
                            <h2 id="player-title" class="text-2xl font-black truncate leading-tight tracking-tight"
                                style="color: var(--text-primary);">Title</h2>
                            <span id="explicit-badge"
                                class="hidden bg-[var(--bg-elevated)] text-[var(--text-tertiary)] text-[9px] font-bold px-1.5 py-0.5 rounded border border-[var(--border-default)]">E</span>
                        </div>
                        <p id="player-artist"
                            class="font-bold uppercase tracking-widest text-xs hover:opacity-80 transition cursor-pointer active:scale-95 origin-left"
                            onclick="UI.openArtistFromPlayer()" style="color: var(--text-secondary);">Artist</p>
                    </div>
                    <div class="flex gap-4">
                        <button id="like-btn" onclick="Library.toggleLike()"
                            class="p-3 surface rounded-full transition active:scale-90 border border-[var(--border-subtle)] shadow-lg hover:border-[var(--accent-secondary)]"><i
                                data-lucide="heart" class="w-5 h-5" style="color: var(--text-tertiary);"></i></button>
                        <button onclick="UI.openAddToPlaylist()"
                            class="p-3 surface rounded-full transition active:scale-90 border border-[var(--border-subtle)] shadow-lg hover:border-[var(--accent-secondary)]"><i
                                data-lucide="plus" class="w-5 h-5" style="color: var(--text-tertiary);"></i></button>
                      
                    </div>
                </div>

                <div class="space-y-3">
                    <input type="range" id="player-progress" value="0" step="0.1"
                        class="w-full h-1 bg-[var(--bg-elevated)] accent-[var(--text-primary)] hover:h-1.5 transition-all"
                        oninput="AudioEngine.seek(this.value)">
                    <div class="flex justify-between text-[10px] font-mono font-medium"
                        style="color: var(--text-tertiary);">
                        <span id="time-cur">0:00</span>
                        <span id="time-total">0:00</span>
                    </div>
                </div>

                <div class="flex justify-between items-center px-2">
                    <button onclick="Queue.toggleShuffle()" id="shuffle-btn"
                        class="p-2 hover:text-[var(--text-primary)] transition active:scale-90"
                        style="color: var(--text-tertiary);"><i data-lucide="shuffle" class="w-5 h-5"></i></button>
                    <button onclick="Queue.prev()" class="p-2 active:scale-90 transition hover:opacity-80"
                        style="color: var(--text-primary);"><i data-lucide="skip-back"
                            class="w-8 h-8 fill-[var(--text-primary)]"></i></button>
                    <button onclick="AudioEngine.toggle()" id="main-play-btn"
                        class="w-20 h-20 bg-[var(--text-primary)] text-[var(--text-inverse)] rounded-full flex items-center justify-center shadow-[0_0_40px_rgba(255,255,255,0.15)] active:scale-95 transition hover:scale-105 border border-[var(--border-subtle)]"><i
                            data-lucide="play" class="w-8 h-8 fill-[var(--text-inverse)] ml-1"></i></button>
                    <button onclick="Queue.next()" class="p-2 active:scale-90 transition hover:opacity-80"
                        style="color: var(--text-primary);"><i data-lucide="skip-forward"
                            class="w-8 h-8 fill-[var(--text-primary)]"></i></button>
                    <button onclick="Queue.toggleLoop()" id="loop-btn"
                        class="p-2 hover:text-[var(--text-primary)] transition active:scale-90"
                        style="color: var(--text-tertiary);"><i data-lucide="repeat" class="w-5 h-5"></i></button>
                </div>

                <div class="flex justify-center">
                    <button onclick="UI.toggleQueue()"
                        class="flex flex-col items-center gap-1 hover:text-[var(--text-primary)] transition"
                        style="color: var(--text-tertiary);">
                        <i data-lucide="list-music" class="w-4 h-4"></i>
                        <span class="text-[9px] font-bold uppercase tracking-widest">Up Next</span>
                    </button>
                </div>
            </div>
            
        </div>

        <!-- === QUEUE SLIDE UP === -->
        <div id="view-queue"
            class="queue-hidden absolute inset-0 z-[150] bg-[var(--bg-app)] flex flex-col border-t border-[var(--border-default)]">
            <div class="flex justify-between items-center p-6 border-b border-[var(--border-subtle)]">
                <div class="w-8"></div> <!-- Drag handle area -->
                <h2 class="text-lg font-black uppercase tracking-wider">Queue</h2>
                <button onclick="UI.toggleQueue()"
                    class="w-8 h-8 rounded-full bg-[var(--bg-surface)] flex items-center justify-center border border-[var(--border-subtle)]"><i
                        data-lucide="x" class="w-4 h-4"></i></button>
            </div>
            <div class="flex-1 overflow-y-auto p-4">
                <div id="queue-now-playing"
                    class="surface rounded-2xl p-6 mb-8 shadow-lg border border-[var(--border-subtle)] flex gap-6">
                </div>
                <h3 class="text-xs font-bold uppercase tracking-widest mb-4 px-2" style="color: var(--text-tertiary);">
                    Up Next</h3>
                <div id="queue-up-next-list" class="space-y-3"></div>
            </div>
        </div>

        <!-- === SETTINGS MODAL === -->
        <div id="modal-settings" class="hidden fixed inset-0 z-[250] glass p-8 pt-16 flex flex-col animate-fade-in">
            <div class="flex justify-between items-center mb-8">
                <h2 class="text-3xl font-black tracking-tight">Settings</h2>
                <button onclick="UI.closeSettings()" class="p-2 surface rounded-full"><i data-lucide="x"
                        class="w-6 h-6"></i></button>
            </div>
            <div class="space-y-8 overflow-y-auto no-scrollbar flex-1 pb-10">
                <!-- Account -->
                <div class="space-y-4">
                    <h3 class="text-xs font-bold uppercase tracking-widest ml-2" style="color: var(--text-tertiary);">
                        Profile</h3>
                    <div class="flex items-center gap-4 surface p-4 rounded-2xl shadow-sm">
                        <div
                            class="w-14 h-14 rounded-full bg-gradient-to-tr from-zinc-700 to-zinc-900 flex items-center justify-center border border-[var(--border-default)]">
                            <i data-lucide="user" class="w-6 h-6 text-zinc-300"></i></div>
                        <div class="flex-1">
                            <input type="text" id="pref-name" onchange="Database.save('user_name', this.value)"
                                class="bg-transparent font-bold text-lg outline-none w-full"
                                style="color: var(--text-primary);" placeholder="Display Name">
                            <p class="text-[10px] uppercase tracking-wider font-bold"
                                style="color: var(--text-tertiary);">SNIPLIT User</p>
                        </div>
                    </div>
                </div>

                <!-- Preferences -->
                <div class="space-y-6">
                    <h3 class="text-xs font-bold uppercase tracking-widest ml-2" style="color: var(--text-tertiary);">
                        Appearance</h3>

                    <div class="flex justify-between items-center py-1 px-2">
                        <div>
                            <span class="text-sm font-bold block" style="color: var(--text-primary);">Light Mode</span>
                            <span class="text-[10px] font-medium" style="color: var(--text-tertiary);">High contrast
                                theme</span>
                        </div>
                        <div class="toggle-switch" id="toggle-lightMode" onclick="UI.toggleLightMode(this)"></div>
                    </div>

                    <h3 class="text-xs font-bold uppercase tracking-widest ml-2 pt-4"
                        style="color: var(--text-tertiary);">Audio</h3>

                    <div class="flex justify-between items-center py-1 px-2">
                        <div>
                            <span class="text-sm font-bold block" style="color: var(--text-primary);">Audio
                                Quality</span>
                            <span class="text-[10px] font-medium" style="color: var(--text-tertiary);">Hi-Res /
                                Lossless</span>
                        </div>
                        <div class="toggle-switch active" id="toggle-quality"
                            onclick="UI.toggleSetting('quality', this)"></div>
                    </div>

                    <div class="flex justify-between items-center py-1 px-2">
                        <div>
                            <span class="text-sm font-bold block" style="color: var(--text-primary);">Normalize</span>
                            <span class="text-[10px] font-medium" style="color: var(--text-tertiary);">Stabilize volume
                                levels</span>
                        </div>
                        <div class="toggle-switch active" id="toggle-normalize"
                            onclick="UI.toggleSetting('normalize', this)"></div>
                    </div>

                    <div class="flex justify-between items-center py-1 px-2">
                        <div>
                            <span class="text-sm font-bold block" style="color: var(--text-primary);">Crossfade</span>
                            <span class="text-[10px] font-medium" style="color: var(--text-tertiary);">Blend between
                                tracks</span>
                        </div>
                        <div class="toggle-switch" id="toggle-crossfade" onclick="UI.toggleSetting('crossfade', this)">
                        </div>
                    </div>

                    <div class="flex justify-between items-center py-1 px-2">
                        <div>
                            <span class="text-sm font-bold block" style="color: var(--text-primary);">Gapless
                                Playback</span>
                            <span class="text-[10px] font-medium" style="color: var(--text-tertiary);">Remove
                                silence</span>
                        </div>
                        <div class="toggle-switch" id="toggle-gapless" onclick="UI.toggleSetting('gapless', this)">
                        </div>
                    </div>

                    <div class="flex justify-between items-center py-1 px-2">
                        <div>
                            <span class="text-sm font-bold block" style="color: var(--text-primary);">Haptics</span>
                            <span class="text-[10px] font-medium" style="color: var(--text-tertiary);">Vibration
                                feedback</span>
                        </div>
                        <div class="toggle-switch active" id="toggle-haptics"
                            onclick="UI.toggleSetting('haptics', this)"></div>
                    </div>
                </div>

                <!-- Data -->
                <div class="pt-8 border-t border-[var(--border-subtle)] space-y-4">
                    <h3 class="text-xs font-bold uppercase tracking-widest ml-2" style="color: var(--text-tertiary);">
                        Data</h3>
                    <div class="flex gap-4">
                        <button onclick="DataManager.exportConfig()"
                            class="flex-1 text-left p-4 rounded-xl surface text-sm font-bold uppercase tracking-wider hover:bg-[var(--bg-surface-hover)] transition flex items-center justify-center gap-2"
                            style="color: var(--text-primary);"><i data-lucide="download" class="w-4 h-4"></i>
                            Export</button>
                        <button onclick="document.getElementById('import-input').click()"
                            class="flex-1 text-left p-4 rounded-xl surface text-sm font-bold uppercase tracking-wider hover:bg-[var(--bg-surface-hover)] transition flex items-center justify-center gap-2"
                            style="color: var(--text-primary);"><i data-lucide="upload" class="w-4 h-4"></i>
                            Import</button>
                        <input type="file" id="import-input" class="hidden" accept=".json"
                            onchange="DataManager.importConfig(this)">
                    </div>
                    <button onclick="UI.logout()"
                        class="w-full text-left p-4 rounded-xl surface text-sm font-bold uppercase tracking-wider hover:bg-[var(--bg-surface-hover)] transition"
                        style="color: var(--text-secondary);">Log Out</button>
                    <button onclick="Database.hardReset()"
                        class="w-full text-left p-4 rounded-xl border border-red-500/30 text-sm font-bold uppercase tracking-wider hover:bg-red-500/10 transition text-red-500">Factory
                        Reset App</button>
                    <div class="text-center pt-4">
                        <p class="text-[10px] font-mono uppercase opacity-50">SNIPLIT v2.0 • Build 2026</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- === ADD TO PLAYLIST === -->
        <div id="modal-add-playlist" class="hidden fixed inset-0 z-[260] glass p-6 pt-20 flex flex-col animate-fade-in">
            <h3 class="text-xl font-black mb-6">Add to Playlist</h3>
            <div id="playlist-select-list" class="space-y-2 overflow-y-auto flex-1"></div>
            <button onclick="document.getElementById('modal-add-playlist').classList.add('hidden')"
                class="mt-4 p-4 text-center text-xs font-bold uppercase"
                style="color: var(--text-tertiary);">Cancel</button>
        </div>

        <!-- === WRAPPED === -->
        <div id="wrapped-modal" class="hidden fixed inset-0 z-[300] bg-[var(--bg-app)] overflow-y-auto">
            <div class="min-h-screen flex flex-col items-center justify-center p-6 text-center space-y-8 pb-24">
                <button onclick="document.getElementById('wrapped-modal').classList.add('hidden')"
                    class="absolute top-6 right-6 p-2 bg-[var(--bg-surface)] rounded-full hover:bg-[var(--bg-elevated)]"><i
                        data-lucide="x" class="w-6 h-6"></i></button>
                <div id="wrapped-slide-container"
                    class="w-full max-w-sm transition-all duration-500 relative min-h-[400px] flex flex-col justify-center items-center">
                </div>
                <button id="wrapped-next-btn" onclick="Wrapped.nextSlide()"
                    class="hidden px-10 py-4 bg-[var(--text-primary)] text-[var(--text-inverse)] rounded-full font-black uppercase tracking-widest text-sm hover:scale-105 transition shadow-xl">Next</button>
            </div>
        </div>

        <!-- === CHANGELOG === -->
        <div id="modal-changelog" class="hidden fixed inset-0 z-[280] bg-[var(--bg-app)] overflow-y-auto">
            <div class="p-6 max-w-md mx-auto pt-20 pb-24">
                <div class="flex justify-between items-center mb-8">
                    <h2 class="text-3xl font-black tracking-tight">Updates</h2>
                    <button onclick="document.getElementById('modal-changelog').classList.add('hidden')"
                        class="p-2 surface rounded-full"><i data-lucide="x" class="w-6 h-6"></i></button>
                </div>
                <div class="space-y-12 border-l border-[var(--border-default)] ml-2 pl-6 relative">
                    <div class="relative">
                        <div
                            class="absolute -left-[31px] top-0 w-4 h-4 bg-[var(--text-primary)] rounded-full border-4 border-[var(--bg-app)]">
                        </div>
                        <h3 class="text-lg font-bold mb-1" style="color: var(--text-primary);">Version 2.0</h3>
                        <p class="text-[10px] font-mono mb-4" style="color: var(--text-tertiary);">CURRENT RELEASE</p>
                        <ul class="space-y-2 text-sm" style="color: var(--text-secondary);">
                            <li>• Advanced Media Session (Lockscreen)</li>
                            <li>• Config Import/Export</li>
                            <li>• Block Artists & Dislike Songs</li>
                            <li>• Light Mode Overhaul</li>
                            <li>• Gapless & Crossfade Audio</li>
                        </ul>
                    </div>
                    <div class="relative">
                        <div
                            class="absolute -left-[31px] top-0 w-4 h-4 bg-[var(--bg-elevated)] rounded-full border-4 border-[var(--bg-app)]">
                        </div>
                        <h3 class="text-lg font-bold mb-1" style="color: var(--text-tertiary);">Version 1.5</h3>
                        <p class="text-[10px] font-mono mb-4" style="color: var(--text-tertiary);">PREVIOUS</p>
                        <ul class="space-y-2 text-sm" style="color: var(--text-tertiary);">
                            <li>• UI Fixes</li>
                            <li>• Performance Optimizations</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- === ALERTS === -->
        <div id="ui-alert" class="modal-overlay">
            <div class="modal-content text-center surface">
                <h3 id="alert-title" class="text-xl font-bold mb-2" style="color: var(--text-primary);">Alert</h3>
                <p id="alert-msg" class="text-sm mb-6" style="color: var(--text-secondary);">Message goes here.</p>
                <button onclick="UI.closeAlert()"
                    class="w-full py-3 bg-[var(--text-primary)] text-[var(--text-inverse)] rounded-lg font-bold uppercase text-sm">OK</button>
            </div>
        </div>
        <div id="ui-confirm" class="modal-overlay">
            <div class="modal-content text-center surface">
                <h3 id="confirm-title" class="text-xl font-bold mb-2" style="color: var(--text-primary);">Confirm</h3>
                <p id="confirm-msg" class="text-sm mb-6" style="color: var(--text-secondary);">Are you sure?</p>
                <div class="flex gap-3">
                    <button onclick="UI.closeConfirm()"
                        class="flex-1 py-3 rounded-xl surface font-bold uppercase text-sm"
                        style="color: var(--text-primary);">Cancel</button>
                    <button id="confirm-yes-btn"
                        class="flex-1 py-3 rounded-xl bg-red-500 text-white font-bold uppercase text-sm">Confirm</button>
                </div>
            </div>
        </div>
        <div id="ui-prompt" class="modal-overlay">
            <div class="modal-content surface">
                <h3 id="prompt-title" class="text-xl font-bold mb-4" style="color: var(--text-primary);">Input</h3>
                <input type="text" id="prompt-input"
                    class="w-full bg-[var(--bg-app)] rounded-xl p-3 text-sm outline-none mb-6 border border-[var(--border-subtle)]"
                    style="color: var(--text-primary);" placeholder="Type here...">
                <div class="flex gap-3">
                    <button onclick="UI.closePrompt()"
                        class="flex-1 py-3 rounded-xl surface font-bold uppercase text-sm"
                        style="color: var(--text-primary);">Cancel</button>
                    <button id="prompt-yes-btn"
                        class="flex-1 py-3 rounded-xl bg-[var(--text-primary)] text-[var(--text-inverse)] font-bold uppercase text-sm">Submit</button>
                </div>
            </div>
        </div>

        <!-- === TOAST === -->
        <div id="toast" style="display: none;"
            class="hidden fixed top-6 left-1/2 -translate-x-1/2 bg-[var(--text-primary)] text-[var(--text-inverse)] px-6 py-3 rounded-full text-xs font-bold uppercase tracking-widest shadow-2xl z-[9999] opacity-0 pointer-events-none transition-opacity duration-300">
            Notification</div>

        <!-- === HIDDEN INPUTS === -->
        <input type="file" id="local-file-input" class="hidden" accept="audio/*" multiple>
    </div>
    <script src="src/main.js"> </script>
</body>

</html>
